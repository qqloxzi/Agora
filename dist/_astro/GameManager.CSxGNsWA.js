import{j as e,G as z}from"./GoBoardReact.BhtI4yqs.js";import{r as n}from"./index.DiEladB3.js";import{s as N}from"./supabase.DgUM0jQD.js";const w=[{title:"(20 kyu-18 kyu)BaÅŸlangÄ±Ã§",levels:[{id:"Kurallar",label:"Kurallar",icon:"ðŸ“–",parent:null},{id:"Esir Alma 1",label:"Esir Alma 1",icon:"ðŸŒ‘",parent:"Kurallar"},{id:"BaÄŸlanma & Kesme",label:"BaÄŸlanma & Kesme",icon:"ðŸŽ¯",parent:"Esir Alma 1"},{id:"Nefes YarÄ±ÅŸÄ±",label:"Nefes YarÄ±ÅŸÄ±",icon:"ðŸš«",parent:"BaÄŸlanma & Kesme"},{id:"YaÅŸam & Ã–lÃ¼m 1",label:"YaÅŸam & Ã–lÃ¼m 1",icon:"ðŸ‘€",parent:"Kurallar"},{id:"Nefes YarÄ±ÅŸÄ±",label:"Nefes YarÄ±ÅŸÄ±",icon:"ðŸƒ",parent:"YaÅŸam & Ã–lÃ¼m 1"},{id:"Ko KuralÄ±",label:"Ko KuralÄ±",icon:"ðŸ”„",parent:"YaÅŸam & Ã–lÃ¼m 1"},{id:"Tesuji 1",label:"Tesuji 1",icon:"âš¡",parent:"Nefes YarÄ±ÅŸÄ±"},{id:"Merdiven",label:"Merdiven",icon:"ðŸªœ",parent:"Tesuji 1"},{id:"File (Net)",label:"File (Net)",icon:"ðŸ•¸ï¸",parent:"Tesuji 1"}]},{title:"ðŸ§± Usta AdayÄ± (Temel TaÅŸlar)",levels:[{id:"Ã–lÃ¼m & KalÄ±m 1",label:"Ã–lÃ¼m & KalÄ±m",icon:"ðŸ’€",parent:null},{id:"AÃ§Ä±lÄ±ÅŸ Prensipleri 1",label:"AÃ§Ä±lÄ±ÅŸ 1",icon:"ðŸŒŸ",parent:"Ã–lÃ¼m & KalÄ±m 1"},{id:"KÃ¶ÅŸe Kapmaca",label:"KÃ¶ÅŸe Kapmaca",icon:"ðŸ“",parent:"AÃ§Ä±lÄ±ÅŸ Prensipleri 1"},{id:"Kenar AÃ§Ä±lÄ±ÅŸÄ±",label:"Kenar AÃ§Ä±lÄ±ÅŸÄ±",icon:"ðŸ“",parent:"AÃ§Ä±lÄ±ÅŸ Prensipleri 1"},{id:"Sente",label:"Sente",icon:"ðŸ—¡ï¸",parent:"Ã–lÃ¼m & KalÄ±m 1"},{id:"Gote",label:"Gote",icon:"ðŸ›¡ï¸",parent:"Sente"},{id:"Åžekil",label:"Åžekil",icon:"ðŸ”º",parent:"Sente"},{id:"Kesme & BaÄŸlama",label:"Kesme",icon:"âœ‚ï¸",parent:"Åžekil"},{id:"Bambu BaÄŸÄ±",label:"Bambu BaÄŸÄ±",icon:"ðŸŽ‹",parent:"Åžekil"}]},{title:"ðŸ‰ Usta Seviyesi (Ä°leri)",levels:[{id:"Joseki",label:"Joseki",icon:"ðŸ“š",parent:null},{id:"Ä°stila",label:"Ä°stila",icon:"ðŸ°",parent:"Joseki"},{id:"Sabaki",label:"Sabaki",icon:"ðŸ¦‹",parent:"Ä°stila"},{id:"Miai",label:"Miai",icon:"âš–ï¸",parent:"Ä°stila"},{id:"SaldÄ±rÄ±",label:"SaldÄ±rÄ±",icon:"âš”ï¸",parent:"Joseki"},{id:"AÄŸÄ±r TaÅŸlar",label:"AÄŸÄ±r TaÅŸlar",icon:"ðŸª¨",parent:"SaldÄ±rÄ±"},{id:"Sayma",label:"Sayma",icon:"ðŸ§®",parent:"SaldÄ±rÄ±"},{id:"Yose (Son Oyun)",label:"Yose",icon:"ðŸ",parent:"Sayma"},{id:"Ko Tehdidi",label:"Ko Tehdidi",icon:"ðŸ’£",parent:"Sayma"}]}],D=r=>{const l=r.map(s=>({...s,children:[]})),d={};l.forEach(s=>d[s.id]=s);const i=[];return l.forEach(s=>{s.parent&&d[s.parent]?d[s.parent].children.push(s):i.push(s)}),i},A=({node:r,completedLevels:l,startLevel:d,allProblems:i})=>{const s=r.parent&&!l.includes(r.parent),h=l.includes(r.id),p=i.filter(m=>m.category===r.id).length;return e.jsxs("div",{className:"tree-node-container",children:[e.jsxs("div",{className:`level-node ${s?"locked":""} ${h?"completed":""}`,onClick:()=>d(r.id,s),title:r.label,children:[e.jsx("div",{className:"node-icon",children:r.icon}),p>0&&e.jsx("span",{className:"node-badge",children:p}),e.jsx("span",{className:"node-label",children:r.label})]}),r.children&&r.children.length>0&&e.jsx("div",{className:"node-children",children:r.children.map(m=>e.jsx(A,{node:m,completedLevels:l,startLevel:d,allProblems:i},m.id))})]})},O=({allProblems:r})=>{const[l,d]=n.useState(null),[i,s]=n.useState("tree"),[h,p]=n.useState([]),[m,B]=n.useState(null),[c,g]=n.useState(0),[y,x]=n.useState(!1),[S,v]=n.useState({correct:0,wrong:0}),[C,b]=n.useState(!1),[Y,j]=n.useState(0);n.useEffect(()=>{(async()=>{const t=localStorage.getItem("goProgress");let o=t?JSON.parse(t):[];p(o);const{data:{user:u}}=await N.auth.getUser();if(u){B(u);const{data:k}=await N.from("user_progress").select("category_id").eq("user_id",u.id);if(k){const J=k.map(M=>M.category_id),K=[...new Set([...o,...J])];p(K),localStorage.setItem("goProgress",JSON.stringify(K))}}})()},[]),n.useEffect(()=>(i==="playing"?document.body.classList.add("fullscreen-mode"):document.body.classList.remove("fullscreen-mode"),()=>document.body.classList.remove("fullscreen-mode")),[i]),n.useEffect(()=>{if(i==="playing"){const a=l?.problems[c],t=a?.solution&&(a.solution.length>0||a.solution.children?.length>0);x(!t)}},[c,i,l]);const P=async a=>{if(!h.includes(a)){const t=[...h,a];if(p(t),localStorage.setItem("goProgress",JSON.stringify(t)),m)try{await N.from("user_progress").insert({user_id:m.id,category_id:a,completed_at:new Date})}catch(o){console.error(o)}}s("result")},E=(a,t)=>{if(t)return alert("Ã–nce bir Ã¶nceki seviyeyi tamamlamalÄ±sÄ±n!");const o=r.filter(u=>u.category===a);if(o.length===0)return alert("Bu kategoride soru yok.");d({id:a,problems:o}),g(0),v({correct:0,wrong:0}),b(!1),j(0),s("playing")},T=()=>{l&&c<l.problems.length-1?(g(a=>a+1),b(!1),j(a=>a+1)):P(l.id)},L=()=>{j(a=>a+1),b(!1)},_=a=>{a?(x(!0),y||v(C?t=>({...t,wrong:t.wrong+1}):t=>({...t,correct:t.correct+1}))):b(!0)},f=l?l.problems[c]:null,G=l?(c+1)/l.problems.length*100:0;return e.jsxs("div",{className:"game-manager-container",children:[i==="tree"&&e.jsxs("div",{className:"tree-view",children:[e.jsxs("header",{className:"tree-header",children:[e.jsx("h1",{children:"ðŸŒ³ Go Yetenek AÄŸacÄ±"}),e.jsx("p",{children:"YukarÄ±dan baÅŸla, kÃ¶kleri salarak ilerle."}),!m&&e.jsx("p",{style:{color:"#ef4444",fontSize:"0.9rem"},children:"âš ï¸ Ä°lerlemenizin kaydedilmesi iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z."})]}),e.jsx("div",{className:"tree-scroll-container",children:w.map((a,t)=>{const o=D(a.levels);return e.jsxs("div",{className:"tree-section",children:[e.jsx("h2",{className:"section-title",style:{textAlign:"center",marginTop:"40px",color:"#2c3e50"},children:a.title}),e.jsx("div",{className:"org-tree",children:o.map(u=>e.jsx(A,{node:u,completedLevels:h,startLevel:E,allProblems:r},u.id))}),t!==w.length-1&&e.jsx("hr",{style:{margin:"40px auto",width:"50%",opacity:.3}})]},t)})})]}),i==="playing"&&f&&e.jsx("div",{className:"playing-view",children:e.jsx("div",{className:"game-layout",children:e.jsxs("div",{className:"board-section board-section-full",children:[e.jsxs("div",{className:"game-navbar",children:[e.jsxs("h3",{children:[l.id," ",e.jsxs("span",{style:{opacity:.6,fontSize:"0.8em"},children:["(",c+1," / ",l.problems.length,")"]})]}),e.jsx("button",{className:"exit-btn",onClick:()=>s("tree"),children:"âœ• Ã‡Ä±kÄ±ÅŸ"})]}),e.jsx("div",{className:"progress-container",children:e.jsx("div",{className:"progress-fill",style:{width:`${G}%`}})}),e.jsx(z,{problem:f,onSolve:_,description:f.description||"Bu hamleyi dikkatli dÃ¼ÅŸÃ¼n."},`${c}-${Y}`),e.jsxs("div",{className:"game-controls-bottom",children:[e.jsx("button",{className:"control-pill-btn btn-prev",disabled:c===0,onClick:()=>{g(a=>a-1),x(!0)},children:"â† Geri"}),e.jsx("button",{className:"control-pill-btn btn-restart",onClick:L,title:"Yeniden BaÅŸlat",children:"â†º"}),e.jsx("button",{className:"control-pill-btn btn-next",disabled:!y,onClick:T,children:c===l.problems.length-1?"Bitir":"Sonraki â†’"})]})]})})}),i==="result"&&e.jsx("div",{className:"result-overlay",children:e.jsxs("div",{className:"result-card",children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"10px"},children:"ðŸŽ‰"}),e.jsx("h2",{className:"result-title",children:"Tebrikler!"}),e.jsxs("p",{className:"result-subtitle",children:['"',l?.id,'" seviyesini tamamladÄ±n.']}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("div",{className:"stat-box correct",children:[e.jsx("span",{className:"stat-number",children:S.correct}),e.jsx("span",{className:"stat-label",children:"DoÄŸru"})]}),e.jsxs("div",{className:"stat-box wrong",children:[e.jsx("span",{className:"stat-number",children:S.wrong}),e.jsx("span",{className:"stat-label",children:"YanlÄ±ÅŸ"})]})]}),e.jsx("button",{className:"nav-btn",style:{background:"var(--tree-accent)",color:"white",width:"100%",padding:"15px",fontSize:"1.1rem"},onClick:()=>s("tree"),children:"AÄŸaca DÃ¶n ve Devam Et â†’"})]})})]})};export{O as default};
