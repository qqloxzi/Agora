import{j as e,G as Y}from"./GoBoardReact.VwRizz0U.js";import{r}from"./index.DiEladB3.js";import{s as y}from"./supabase.DgUM0jQD.js";const $=[{title:"BaÅŸlangÄ±Ã§ (20-18k)",levels:[{id:"Kurallar",label:"Kurallar",icon:"ðŸ“–",parent:null},{id:"Esir Alma 1",label:"Esir Alma 1",icon:"ðŸŒ‘",parent:"Kurallar"},{id:"Ä°ki GÃ¶z KavramÄ±",label:"Ä°ki GÃ¶z",icon:"ðŸ‘€",parent:"Esir Alma 1"},{id:"Nefes YarÄ±ÅŸÄ±",label:"Nefes YarÄ±ÅŸÄ±",icon:"ðŸƒ",parent:"Ä°ki GÃ¶z KavramÄ±"},{id:"Tesuji 1",label:"Tesuji 1",icon:"âš¡",parent:"Nefes YarÄ±ÅŸÄ±"}]},{title:"Temel TaÅŸlar (17-12k)",levels:[{id:"Ã–lÃ¼m & KalÄ±m 1",label:"Ã–lÃ¼m & KalÄ±m",icon:"ðŸ’€",parent:null},{id:"AÃ§Ä±lÄ±ÅŸ Prensipleri 1",label:"AÃ§Ä±lÄ±ÅŸ 1",icon:"ðŸŒŸ",parent:"Ã–lÃ¼m & KalÄ±m 1"},{id:"Sente",label:"Sente",icon:"ðŸ—¡ï¸",parent:"AÃ§Ä±lÄ±ÅŸ Prensipleri 1"},{id:"Åžekil",label:"Åžekil",icon:"ðŸ”º",parent:"Sente"}]},{title:"Ä°leri Seviye (11-6k)",levels:[{id:"Joseki",label:"Joseki",icon:"ðŸ“š",parent:null},{id:"Ä°stila",label:"Ä°stila",icon:"ðŸ°",parent:"Joseki"},{id:"SaldÄ±rÄ±",label:"SaldÄ±rÄ±",icon:"âš”ï¸",parent:"Ä°stila"},{id:"Sayma",label:"Sayma",icon:"ðŸ§®",parent:"SaldÄ±rÄ±"}]}],R=({allProblems:S})=>{const[a,C]=r.useState(null),[c,o]=r.useState("tree"),[d,h]=r.useState([]),[b,P]=r.useState(null),[n,x]=r.useState(0),[k,g]=r.useState(!1),[w,j]=r.useState({correct:0,wrong:0}),[A,m]=r.useState(!1),[E,v]=r.useState(0);r.useEffect(()=>{(async()=>{const t=localStorage.getItem("goProgress");let l=t?JSON.parse(t):[];h(l);const{data:{user:i}}=await y.auth.getUser();if(i){P(i);const{data:u}=await y.from("user_progress").select("category_id").eq("user_id",i.id);if(u){const f=u.map(J=>J.category_id),p=[...new Set([...l,...f])];h(p),localStorage.setItem("goProgress",JSON.stringify(p))}}})()},[]),r.useEffect(()=>(c==="playing"?document.body.classList.add("fullscreen-mode"):document.body.classList.remove("fullscreen-mode"),()=>document.body.classList.remove("fullscreen-mode")),[c]),r.useEffect(()=>{if(c==="playing"){const s=a?.problems[n],t=s?.solution&&(s.solution.length>0||s.solution.children?.length>0);g(!t)}},[n,c,a]);const L=async s=>{if(!d.includes(s)){const t=[...d,s];if(h(t),localStorage.setItem("goProgress",JSON.stringify(t)),b)try{await y.from("user_progress").insert({user_id:b.id,category_id:s,completed_at:new Date})}catch(l){console.error(l)}}o("result")},K=(s,t)=>{if(t)return alert("Ã–nce bir Ã¶nceki seviyeyi tamamlamalÄ±sÄ±n!");const l=S.filter(i=>i.category===s);if(l.length===0)return alert("Bu kategoride soru yok.");C({id:s,problems:l}),x(0),j({correct:0,wrong:0}),m(!1),v(0),o("playing")},z=()=>{a&&n<a.problems.length-1?(x(s=>s+1),m(!1),v(s=>s+1)):L(a.id)},G=()=>{v(s=>s+1),m(!1)},_=s=>{s?(g(!0),k||j(A?t=>({...t,wrong:t.wrong+1}):t=>({...t,correct:t.correct+1}))):m(!0)},N=a?a.problems[n]:null,B=a?(n+1)/a.problems.length*100:0;return e.jsxs("div",{className:"game-manager-container",children:[c==="tree"&&e.jsxs("div",{className:"tree-view",children:[e.jsxs("header",{className:"tree-header",children:[e.jsx("h1",{children:"Go Yetenek AÄŸacÄ±"}),e.jsx("p",{children:"Usta bir oyuncu olmak iÃ§in yolu takip et."}),!b&&e.jsx("p",{style:{color:"#ef4444",fontSize:"0.9rem"},children:"âš ï¸ Ä°lerlemenizin kaydedilmesi iÃ§in giriÅŸ yapmalÄ±sÄ±nÄ±z."})]}),e.jsx("div",{className:"columns-wrapper",children:$.map((s,t)=>e.jsxs("div",{className:"tree-column",children:[e.jsx("h3",{className:"column-title",children:s.title}),e.jsx("div",{className:"nodes-container",children:s.levels.map(l=>{const i=l.parent&&!d.includes(l.parent),u=d.includes(l.id),f=S.filter(p=>p.category===l.id).length;return e.jsxs("div",{className:"node-wrapper",children:[l.parent&&e.jsx("div",{className:`connector ${i?"locked":""}`}),e.jsxs("div",{className:`level-node ${i?"locked":""} ${u?"completed":""}`,onClick:()=>K(l.id,i),children:[e.jsx("div",{className:"node-icon",children:l.icon}),e.jsx("span",{className:"node-badge",children:f})]}),e.jsx("span",{className:"node-label",children:l.label})]},l.id)})})]},t))})]}),c==="playing"&&N&&e.jsx("div",{className:"playing-view",children:e.jsxs("div",{className:"game-layout",children:[e.jsxs("div",{className:"board-section",children:[e.jsxs("div",{className:"game-navbar",children:[e.jsxs("h3",{children:[a.id," ",e.jsxs("span",{style:{opacity:.6,fontSize:"0.8em"},children:["(",n+1," / ",a.problems.length,")"]})]}),e.jsx("button",{className:"exit-btn",onClick:()=>o("tree"),children:"âœ• Ã‡Ä±kÄ±ÅŸ"})]}),e.jsx("div",{className:"progress-container",children:e.jsx("div",{className:"progress-fill",style:{width:`${B}%`}})}),e.jsx(Y,{problem:N,onSolve:_},`${n}-${E}`),e.jsxs("div",{className:"game-controls-bottom",children:[e.jsx("button",{className:"control-pill-btn btn-prev",disabled:n===0,onClick:()=>{x(s=>s-1),g(!0)},children:"â† Geri"}),e.jsx("button",{className:"control-pill-btn btn-restart",onClick:G,title:"Yeniden BaÅŸlat",children:"â†º"}),e.jsx("button",{className:"control-pill-btn btn-next",disabled:!k,onClick:z,children:n===a.problems.length-1?"Bitir":"Sonraki â†’"})]})]}),e.jsx("div",{className:"info-only-section",children:e.jsx("div",{className:"info-card-wrapper",children:e.jsxs("div",{className:"description-box pop-animation",children:[e.jsx("h4",{children:"ðŸ’¡ Ä°pucu"}),e.jsx("p",{children:N.description||"Bu hamleyi dikkatli dÃ¼ÅŸÃ¼n."})]},n)})})]})}),c==="result"&&e.jsx("div",{className:"result-overlay",children:e.jsxs("div",{className:"result-card",children:[e.jsx("div",{style:{fontSize:"4rem",marginBottom:"10px"},children:"ðŸŽ‰"}),e.jsx("h2",{className:"result-title",children:"Tebrikler!"}),e.jsxs("p",{className:"result-subtitle",children:['"',a?.id,'" seviyesini tamamladÄ±n.']}),e.jsxs("div",{className:"stats-row",children:[e.jsxs("div",{className:"stat-box correct",children:[e.jsx("span",{className:"stat-number",children:w.correct}),e.jsx("span",{className:"stat-label",children:"DoÄŸru"})]}),e.jsxs("div",{className:"stat-box wrong",children:[e.jsx("span",{className:"stat-number",children:w.wrong}),e.jsx("span",{className:"stat-label",children:"YanlÄ±ÅŸ"})]})]}),e.jsx("button",{className:"nav-btn",style:{background:"var(--tree-accent)",color:"white",width:"100%",padding:"15px",fontSize:"1.1rem"},onClick:()=>o("tree"),children:"AÄŸaca DÃ¶n ve Devam Et â†’"})]})})]})};export{R as default};
