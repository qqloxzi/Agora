import{r as k}from"./index.DiEladB3.js";var O={exports:{}},E={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var X;function le(){if(X)return E;X=1;var h=Symbol.for("react.transitional.element"),x=Symbol.for("react.fragment");function S(N,v,c){var j=null;if(c!==void 0&&(j=""+c),v.key!==void 0&&(j=""+v.key),"key"in v){c={};for(var R in v)R!=="key"&&(c[R]=v[R])}else c=v;return v=c.ref,{$$typeof:h,type:N,key:j,ref:v!==void 0?v:null,props:c}}return E.Fragment=x,E.jsx=S,E.jsxs=S,E}var W;function ce(){return W||(W=1,O.exports=le()),O.exports}var a=ce();const de=({problem:h,isTeacher:x=!1,onSolve:S=null})=>{const N=k.useRef(null),v=k.useRef(null),c=k.useRef({size:9,stones:[],labels:[],turn:"black",history:[],moveTree:{children:[]},currentNode:null,lastMove:null,isLocked:!1,hoverPos:{x:-1,y:-1},hasSolution:!1,mode:"SOLVE",initialStateStr:"",recordingStartColor:"black"}),[j,R]=k.useState(""),[K,Z]=k.useState("#fff"),[M,C]=k.useState("black"),[A,Q]=k.useState({col:[],row:[]}),[B,L]=k.useState("SETUP"),[J,Y]=k.useState(9),P=k.useRef(typeof Audio<"u"?new Audio("/sounds/stone.mp3"):null);k.useEffect(()=>($(),window.addEventListener("resize",H),()=>window.removeEventListener("resize",H)),[h]);const $=()=>{const e=c.current;if(e.size=h?.size||9,Y(e.size),D(e.size),e.turn=h?.turn||"black",e.recordingStartColor=e.turn,e.lastMove=h?.lastMove||null,e.mode=x?"SETUP":"SOLVE",L(e.mode),h?.solution)if(Array.isArray(h.solution)&&h.solution.length>0){let t={children:[]};e.moveTree=t,h.solution.forEach(o=>{const r={...o,children:[],status:null};t.children.push(r),t=r}),t.status="correct",e.hasSolution=!0}else h.solution.children?(e.moveTree=h.solution,e.hasSolution=!0):(e.moveTree={children:[]},e.hasSolution=!1);else e.moveTree={children:[]},e.hasSolution=!1;if(e.currentNode=e.moveTree,h?.initialState)try{const t=typeof h.initialState=="string"?JSON.parse(h.initialState):h.initialState;Array.isArray(t)&&t.length>0&&(e.stones=t,e.initialStateStr=typeof h.initialState=="string"?h.initialState:JSON.stringify(t))}catch(t){console.error("Parse Error",t)}C(e.turn),R(x?"√ñƒüretmen Modu: SETUP":e.hasSolution?"":"Analiz Modu"),q(e.size),requestAnimationFrame(g)},D=e=>{const t=c.current;t.size=e,t.stones=Array(e).fill(0).map(()=>Array(e).fill(null)),t.labels=Array(e).fill(0).map(()=>Array(e).fill(null)),t.history=[],t.isLocked=!1,t.hoverPos={x:-1,y:-1}},q=e=>{const t=[],o=[];for(let r=0;r<e;r++)t.push(String.fromCharCode(65+(r>=8?r+1:r)));for(let r=0;r<e;r++)o.push(e-r);Q({col:t,row:o})},ee=e=>{if(!x)return;const t=c.current;t.size=e,Y(e),D(e),t.moveTree={children:[]},t.currentNode=t.moveTree,t.initialStateStr="",t.history=[],t.lastMove=null,q(e),R(`${e}x${e} Tahta Hazƒ±r`),requestAnimationFrame(g)},F=e=>{const t=c.current;e==="SETUP"?(t.mode="SETUP",p("Ta≈ülarƒ± dizin.","#fff")):e==="RECORD"&&(t.initialStateStr=JSON.stringify(t.stones),t.recordingStartColor=t.turn,t.moveTree={children:[]},t.currentNode=t.moveTree,t.history=[],t.mode="RECORD",p("Kayƒ±t Ba≈üladƒ±","#f1c40f")),L(e)},te=()=>{const e=c.current;if(!e.currentNode||e.currentNode===e.moveTree){p("Ba≈ülangƒ±√ßtasƒ±nƒ±z, geri alƒ±namaz.","#e74c3c");return}if(e.history.length>0){const t=e.history.pop();e.stones=JSON.parse(t)}else e.initialStateStr&&(e.stones=JSON.parse(e.initialStateStr));e.currentNode.parent?e.currentNode=e.currentNode.parent:e.currentNode=e.moveTree,e.turn=e.turn==="black"?"white":"black",C(e.turn),e.currentNode&&e.currentNode!==e.moveTree?e.lastMove={x:e.currentNode.x,y:e.currentNode.y,color:e.currentNode.color}:e.lastMove=null,p("Hamle geri alƒ±ndƒ±.","#f1c40f"),g()},I=e=>{const t=c.current;if(t.mode==="RECORD"){if(!t.currentNode||t.currentNode===t.moveTree){p("Hen√ºz hamle yok!","#e74c3c");return}t.currentNode.status=e,p(e==="correct"?"‚úÖ ƒ∞≈üaretlendi":"‚ùå ƒ∞≈üaretlendi",e==="correct"?"#2ecc71":"#e74c3c")}},re=()=>{const e=c.current,t=d=>{const{parent:f,...b}=d;return b.children&&b.children.length>0&&(b.children=b.children.map(m=>t(m))),b},o=t(e.moveTree),r=prompt("Soru Ba≈ülƒ±ƒüƒ±:")||"Yeni Soru",n=prompt("Kategori:")||"Genel",i=prompt("A√ßƒ±klama:")||"",u={id:`prob-${Date.now()}`,size:e.size,labels:JSON.stringify(e.labels),turn:e.recordingStartColor,title:r,category:n,description:i,initialState:e.initialStateStr||JSON.stringify(e.stones),lastMove:e.lastMove,solution:o},l=JSON.stringify(u,null,2).replace(/"([a-zA-Z0-9_]+)":/g,"$1:");console.log("--- JS OBJE √áIKTISI ---"),console.log(l),navigator.clipboard.writeText(l).then(()=>alert("JS Objesi formatƒ±nda kopyalandƒ±!")).catch(()=>{console.error("Kopyalama ba≈üarƒ±sƒ±z, konsola yazƒ±ldƒ±."),console.log(l)})},oe=()=>{const e=c.current;e.turn=e.turn==="black"?"white":"black",C(e.turn)},T=(e,t)=>e>=0&&e<c.current.size&&t>=0&&t<c.current.size,z=(e,t,o,r,n=new Set)=>{const i=`${e},${t}`;if(n.has(i))return 0;n.add(i);let u=0;return[[e+1,t],[e-1,t],[e,t+1],[e,t-1]].forEach(([s,l])=>{T(s,l)&&(r[s][l]?r[s][l].color===o&&(u+=z(s,l,o,r,n)):u++)}),u},G=(e,t,o,r)=>{const n=r[e][t];!n||n.color!==o||(r[e][t]=null,[[e+1,t],[e-1,t],[e,t+1],[e,t-1]].forEach(([i,u])=>{T(i,u)&&G(i,u,o,r)}))},w=(e,t,o)=>{const r=c.current,n=JSON.stringify(r.stones),i=JSON.parse(n);if(i[e][t])return!1;i[e][t]={color:o};let u=!1;const s=o==="black"?"white":"black";if([[e+1,t],[e-1,t],[e,t+1],[e,t-1]].forEach(([d,f])=>{T(d,f)&&i[d][f]&&i[d][f].color===s&&z(d,f,s,i)===0&&(G(d,f,s,i),u=!0)}),!u&&z(e,t,o,i)===0)return p("ƒ∞ntihar Yasak!","#e74c3c"),!1;const l=JSON.stringify(i);return r.history.includes(l)?(p("Ko Kuralƒ±!","#e74c3c"),!1):(r.history.push(n),r.stones=i,r.lastMove={x:e,y:t,color:o},P.current&&(P.current.currentTime=0,P.current.play().catch(()=>{})),!0)},g=()=>{const e=N.current;if(!e)return;const t=e.getContext("2d",{alpha:!1}),o=c.current,r=o.size,n=window.devicePixelRatio||2,i=e.getBoundingClientRect();e.width=i.width*n,e.height=i.height*n,t.scale(n,n);const u=i.width,s=30,l=(u-s*2)/(r-1);t.fillStyle="#f2b06d",t.fillRect(0,0,u,u),t.lineWidth=1,t.strokeStyle="#2b1d0e",t.beginPath();for(let m=0;m<r;m++){const y=Math.round(s+m*l)+.5;t.moveTo(y,s),t.lineTo(y,u-s),t.moveTo(s,y),t.lineTo(u-s,y)}t.stroke();const d=r===19?[3,9,15]:r===13?[3,6,9]:[2,4,6];r>=9&&(t.fillStyle="#000",d.forEach(m=>{d.forEach(y=>{t.beginPath(),t.arc(s+m*l,s+y*l,3,0,Math.PI*2),t.fill()})})),o.stones.forEach((m,y)=>{m.forEach((V,ie)=>{V&&U(t,y,ie,V.color,l,s,1)})});const{x:f,y:b}=o.hoverPos;if(!o.isLocked&&T(f,b)&&!o.stones[f][b]&&U(t,f,b,o.turn,l,s,.5),o.lastMove&&o.stones[o.lastMove.x][o.lastMove.y]){const m=o.lastMove;t.beginPath(),t.arc(s+m.x*l,s+m.y*l,l*.15,0,Math.PI*2),t.fillStyle=o.stones[m.x][m.y].color==="black"?"white":"black",t.fill()}},U=(e,t,o,r,n,i,u)=>{const s=i+t*n,l=i+o*n,d=n*.48;if(e.save(),e.globalAlpha=u,u===1&&(e.shadowColor="rgba(0,0,0,0.4)",e.shadowBlur=4,e.shadowOffsetX=2,e.shadowOffsetY=2),e.beginPath(),e.arc(s,l,d,0,Math.PI*2),r==="black"){const f=e.createRadialGradient(s-d*.3,l-d*.3,d*.1,s,l,d);f.addColorStop(0,"#666"),f.addColorStop(1,"#000"),e.fillStyle=f}else{const f=e.createRadialGradient(s-d*.3,l-d*.4,d*.05,s,l,d);f.addColorStop(0,"#fff"),f.addColorStop(1,"#ccc"),e.fillStyle=f}e.fill(),e.restore()},ne=e=>{const t=c.current;if(t.isLocked&&t.mode==="SOLVE"){N.current.style.cursor="default";return}const o=N.current.getBoundingClientRect(),r=30,n=(o.width-r*2)/(t.size-1),i=e.clientX-o.left-r,u=e.clientY-o.top-r,s=Math.round(i/n),l=Math.round(u/n);T(s,l)?(t.hoverPos.x!==s||t.hoverPos.y!==l)&&(t.hoverPos={x:s,y:l},N.current.style.cursor="pointer",requestAnimationFrame(g)):(t.hoverPos={x:-1,y:-1},N.current.style.cursor="default",requestAnimationFrame(g))},se=()=>{const e=c.current,{x:t,y:o}=e.hoverPos;if(!(!T(t,o)||e.isLocked)&&!e.stones[t][o]){if(e.mode==="SETUP"){e.stones[t][o]={color:e.turn},g();return}if(e.mode==="RECORD"){const r=e.turn;if(w(t,o,r)){const n={x:t,y:o,color:r,children:[],status:null,parent:e.currentNode},i=e.currentNode.children.find(u=>u.x===t&&u.y===o);i?(e.currentNode=i,p("Mevcut varyasyon","#3498db")):(e.currentNode.children.push(n),e.currentNode=n),e.turn=e.turn==="black"?"white":"black",C(e.turn),g()}return}if(e.mode==="SOLVE"){const r=e.currentNode.children?.find(n=>n.x===t&&n.y===o);r?(w(t,o,r.color),e.currentNode=r,e.turn=e.turn==="black"?"white":"black",C(e.turn),g(),r.children&&r.children.length>0?setTimeout(()=>{const n=r.children[0];w(n.x,n.y,n.color),e.currentNode=n,e.turn=e.turn==="black"?"white":"black",C(e.turn),g(),_(n)},500):_(r)):e.hasSolution?(p("Yanlƒ±≈ü Hamle","#e74c3c"),e.isLocked=!0,S&&S(!1)):(w(t,o,e.turn),e.turn=e.turn==="black"?"white":"black",C(e.turn),g())}}},_=e=>{if(e.children&&e.children.length>0){e.status==="wrong"&&(p("Yanlƒ±≈ü Yol","#e74c3c"),S&&S(!1));return}e.status==="correct"?(p("Tebrikler! Doƒüru √á√∂z√ºm.","#2ecc71"),c.current.isLocked=!0,S&&S(!0)):e.status==="wrong"?(p("Yanlƒ±≈ü Yol","#e74c3c"),c.current.isLocked=!0,S&&S(!1)):(!e.children||e.children.length===0)&&(p("Tebrikler!","#2ecc71"),c.current.isLocked=!0,S&&S(!0))},p=(e,t)=>{R(e),Z(t)},H=()=>requestAnimationFrame(g),ae=()=>$();return a.jsxs("div",{className:"go-app-react",ref:v,children:[(!x||B==="RECORD")&&a.jsx("div",{className:"top-info-bar",children:a.jsxs("div",{className:"turn-badge",children:[a.jsx("div",{className:`turn-indicator ${M}`}),a.jsx("span",{children:M==="black"?"Siyah":"Beyaz"})]})}),a.jsx("div",{className:"status",style:{color:K},children:j}),a.jsx("div",{className:"go-wrapper-shadow",children:a.jsxs("div",{className:"go-container",children:[a.jsxs("div",{className:"coords-layer",children:[A.col.map((e,t)=>a.jsx("span",{className:"coord-label col",style:{left:`${t*100/(c.current.size-1)}%`},children:e},`c-${t}`)),A.row.map((e,t)=>a.jsx("span",{className:"coord-label row",style:{top:`${t*100/(c.current.size-1)}%`},children:e},`r-${t}`))]}),a.jsx("canvas",{ref:N,className:"goBoard",onMouseMove:ne,onMouseLeave:()=>{c.current.hoverPos={x:-1,y:-1},g()},onClick:se})]})}),x&&a.jsxs("div",{className:"bottom-controls",style:{flexWrap:"wrap",justifyContent:"center"},children:[a.jsx("button",{className:"control-btn resetBtn",onClick:ae,title:"Ba≈üa D√∂n",children:"‚Ü∫"}),a.jsxs("div",{className:"teacher-controls",style:{display:"flex",gap:"10px",alignItems:"center",marginLeft:"10px"},children:[a.jsx("div",{style:{width:"1px",height:"30px",background:"#555"}}),B==="SETUP"?a.jsxs(a.Fragment,{children:[a.jsx("div",{style:{display:"flex",gap:"5px"},children:[9,13,19].map(e=>a.jsx("button",{onClick:()=>ee(e),style:{background:J===e?"#3498db":"transparent",border:"1px solid #7f8c8d",color:J===e?"white":"#bdc3c7",borderRadius:"4px",padding:"5px 10px",cursor:"pointer"},children:e},e))}),a.jsx("div",{style:{width:"1px",height:"30px",background:"#555"}}),a.jsx("button",{className:"control-btn",onClick:()=>oe(),title:"Renk Deƒüi≈ütir",children:a.jsx("div",{className:`turn-indicator ${M==="black"?"white":"black"}`})}),a.jsx("button",{className:"control-btn",style:{borderRadius:"5px",width:"auto",padding:"0 10px",fontSize:"0.9rem"},onClick:()=>F("RECORD"),children:"üî¥ Kayƒ±t"})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{className:"control-btn",style:{background:"#2ecc71"},onClick:()=>I("correct"),title:"Doƒüru",children:"‚úÖ"}),a.jsx("button",{className:"control-btn",style:{background:"#e74c3c"},onClick:()=>I("wrong"),title:"Yanlƒ±≈ü",children:"‚ùå"}),a.jsx("button",{className:"control-btn",style:{background:"#e67e22"},onClick:te,title:"Bir Adƒ±m Geri Al",children:"‚Ü©Ô∏è"}),a.jsx("div",{style:{width:"1px",height:"30px",background:"#555"}}),a.jsx("button",{className:"control-btn",style:{borderRadius:"5px",width:"auto",padding:"0 10px",fontSize:"0.9rem"},onClick:re,children:"üíæ ƒ∞ndir"}),a.jsx("button",{className:"control-btn",style:{fontSize:"0.8rem"},onClick:()=>F("SETUP"),title:"Setup",children:"‚öôÔ∏è"})]})]})]})]})};export{de as G,a as j};
