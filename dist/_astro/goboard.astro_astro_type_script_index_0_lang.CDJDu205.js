var z={},M={},F={},q={},et;function O(){return et||(et=1,Object.defineProperty(q,"__esModule",{value:!0}),q.default={flatten:function(i){return i.reduce(function(o,g){return o.concat(g)})},flatMap:function(i,o){return Array.prototype.concat.apply([],i.map(o))},cartesianProduct:function(i,o){return this.flatten(i.map(function(g){return o.map(function(_){return[g,_]})}))},randomID:function(i){var o=[0,1,2,3].map(function(){return Math.floor(Math.random()*65536).toString(16).substring(1)}).join("");return i+"-"+o},clone:function(i){return i.cloneNode(!0)},createElement:function(i,o){var g=document.createElement(i);return typeof o<"u"&&o.class&&(g.className=o.class),g},createSVGElement:function(i,o){var g=this,_="http://www.w3.org/2000/svg",s=document.createElementNS(_,i);return typeof o<"u"&&(o.class&&o.class.split(" ").forEach(function(t){g.addClass(s,t)}),o.attributes&&Object.keys(o.attributes).forEach(function(t){s.setAttribute(t,o.attributes[t])}),o.text&&(s.textContent=o.text.toString())),s},appendElement:function(i,o){i.insertBefore(o,null)},addEventListener:function(i,o,g){i.addEventListener(o,g,!1)},removeClass:function(i,o){if(this.hasClass(i,o)){if(i.classList&&i.classList.remove){i.classList.remove(o);return}var g=RegExp("\\b"+o+"\\b","g");i instanceof SVGElement?i.setAttribute("class",i.getAttribute("class").replace(g,"")):i.className=i.getAttribute("class").replace(g,"")}},addClass:function(i,o){if(i.classList&&i.classList.add){i.classList.add(o);return}i instanceof SVGElement?i.setAttribute("class",i.getAttribute("class")+" "+o):i.className=i.getAttribute("class")+" "+o},hasClass:function(i,o){if(i.classList&&i.classList.contains)return i.classList.contains(o);var g=RegExp("\\b"+o+"\\b","g");return i instanceof SVGElement?g.test(i.getAttribute("class")):g.test(i.className)},toggleClass:function(i,o){if(i.classList&&i.classList.toggle){i.classList.toggle(o);return}this.hasClass(i,o)?this.removeClass(i,o):this.addClass(i,o)},unique:function(i){var o=[];return i.forEach(function(g){o.indexOf(g)<0&&o.push(g)}),o}}),q}var B={},rt;function mt(){if(rt)return B;rt=1,Object.defineProperty(B,"__esModule",{value:!0});var S=(function(){function s(t,r){var u=[],e=!0,n=!1,a=void 0;try{for(var d=t[Symbol.iterator](),l;!(e=(l=d.next()).done)&&(u.push(l.value),!(r&&u.length===r));e=!0);}catch(E){n=!0,a=E}finally{try{!e&&d.return&&d.return()}finally{if(n)throw a}}return u}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return s(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),i=O(),o=g(i);function g(s){return s&&s.__esModule?s:{default:s}}var _=function(t,r){var u=r.hooks,e=r.options;this.INTERSECTION_GAP_SIZE=28,this.GUTTER_MARGIN=this.INTERSECTION_GAP_SIZE-3,this.BASE_MARGIN=this.INTERSECTION_GAP_SIZE-10,this.hasCoordinates=t.hasAttribute("data-include-coordinates"),this.MARGIN=this.hasCoordinates?this.BASE_MARGIN+this.GUTTER_MARGIN:this.BASE_MARGIN,this.boardElement=t,this.grid=[],this.hooks=u||{},this._options=e||{},this._initialized=!1,this._options.fuzzyStonePlacement&&(o.default.addClass(t,"tenuki-fuzzy-placement"),o.default.removeClass(t,"tenuki-board-flat"),o.default.addClass(t,"tenuki-board-nonflat"),this.smallerStones=!0),this.flatStones=o.default.hasClass(t,"tenuki-board-flat"),this.flatStones||o.default.addClass(t,"tenuki-board-nonflat")};return _.hoshiPositionsFor=function(s){var t=[];if(s<7){if(s>1&&s%2===1){var r={};r.top=(s-1)/2,r.left=r.top,t.push(r)}}else for(var u=s>11?3:2,e=0;e<3;e++)for(var n=0;n<3;n++)if(!((s===7||s%2===0)&&(e===1||n===1))){var a={};e===0&&(a.top=u),e===1&&(a.top=(s+1)/2-1),e===2&&(a.top=s-u-1),n===0&&(a.left=u),n===1&&(a.left=(s+1)/2-1),n===2&&(a.left=s-u-1),t.push(a)}return t},_.prototype={_setup:function(t){var r=this,u=this.boardElement;r.BOARD_LENGTH=2*this.MARGIN+(t.boardSize-1)*(this.INTERSECTION_GAP_SIZE+1);var e=o.default.createElement("div",{class:"tenuki-inner-container"});r.innerContainer=e,o.default.appendElement(u,e);var n=o.default.createElement("div",{class:"tenuki-zoom-container"});r.zoomContainer=n,o.default.appendElement(e,n),r.cancelZoomElement=o.default.createElement("div",{class:"cancel-zoom"});var a=o.default.createElement("div",{class:"cancel-zoom-backdrop"});o.default.addEventListener(r.cancelZoomElement,"click",function(E){return E.preventDefault(),r.zoomOut(),!1}),o.default.addEventListener(a,"click",function(E){return E.preventDefault(),r.zoomOut(),!1}),o.default.appendElement(e,r.cancelZoomElement),o.default.appendElement(e,a);var d=function(p,f){var h=!1,c=function(){h||(h=!0,window.requestAnimationFrame(function(){window.dispatchEvent(new CustomEvent(f)),h=!1}))};window.addEventListener(p,c)};d("resize","optimizedResize");var l=this.generateBoard(t,{hasCoordinates:this.hasCoordinates,smallerStones:this.smallerStones,flatStones:this.flatStones});o.default.appendElement(n,l),window.requestAnimationFrame(function(){n.style.willChange="transform",r.computeSizing()}),window.addEventListener("optimizedResize",function(){r.computeSizing()}),r.touchmoveChangedTouch=null,r.touchstartEventHandler=r.handleTouchStart.bind(r),r.touchmoveEventHandler=r.handleTouchMove.bind(r),r.touchendEventHandler=r.handleTouchEnd.bind(r),o.default.addEventListener(r.innerContainer,"touchstart",r.touchstartEventHandler),o.default.addEventListener(r.innerContainer,"touchend",r.touchendEventHandler),o.default.addEventListener(r.innerContainer,"touchmove",r.touchmoveEventHandler)},computeSizing:function(){var t=this,r=this.innerContainer,u=this.zoomContainer,e=this.boardElement;r.style.height="",r.style.width="",u.style.height="",u.style.width="",r.style.transform="",e.style.width="",e.style.height="",t._touchEventFired=null,r.style.width=t.BOARD_LENGTH+"px",r.style.height=t.BOARD_LENGTH+"px",u.style.width=t.BOARD_LENGTH+"px",u.style.height=t.BOARD_LENGTH+"px";var n=r.parentNode.clientWidth/r.clientWidth,a=r.parentNode.clientHeight/r.clientHeight,d=Math.min(n,a);d>0&&(d<1?o.default.addClass(e,"tenuki-scaled"):o.default.removeClass(e,"tenuki-scaled"),(d<1||d>1)&&(r.style["transform-origin"]="top left",r.style.transform="scale3d("+d+", "+d+", 1)")),e.style.width=r.getBoundingClientRect().width+"px",e.style.height=r.getBoundingClientRect().height+"px",u.style.willChange="",window.requestAnimationFrame(function(){u.style.willChange="transform"})},addIntersectionEventListeners:function(t,r,u){var e=this;o.default.addEventListener(t,"mouseenter",function(){var n=r,a=u,d=e.hooks.hoverValue(n,a);d&&(o.default.addClass(t,"hovered"),o.default.addClass(t,d))}),o.default.addEventListener(t,"mouseleave",function(){o.default.hasClass(this,"hovered")&&(o.default.removeClass(t,"hovered"),o.default.removeClass(t,"black"),o.default.removeClass(t,"white")),e.resetTouchedPoint()}),o.default.addEventListener(t,"click",function(){var n=r,a=u;if(!e._touchEventFired||document.body.clientWidth/window.innerWidth>1||e.hooks.gameIsOver()){e.hooks.handleClick(n,a);return}e.touchedPoint&&t===e.touchedPoint?e.hooks.handleClick(n,a):e.showPossibleMoveAt(t,n,a)})},handleTouchStart:function(t){var r=this;if(r._touchEventFired=!0,t.touches.length>1){r.zoomedIn&&t.preventDefault();return}if(r.zoomedIn){var u=t.changedTouches[0].clientX,e=t.changedTouches[0].clientY;r.dragStartX=u,r.dragStartY=e,r.zoomContainer.style.transition="none",r.animationFrameRequestID=window.requestAnimationFrame(r.processDragDelta.bind(r))}},handleTouchMove:function(t){var r=this;if(!(t.touches.length>1)){if(!r.zoomedIn)return!0;t.preventDefault(),r.touchmoveChangedTouch=t.changedTouches[0],r.moveInProgress=!0}},handleTouchEnd:function(t){var r=this;t.touches.length>1||r.zoomedIn&&(r.zoomContainer.style.transition="",r.moveInProgress&&(r.translateY=r.lastTranslateY,r.translateX=r.lastTranslateX,r.moveInProgress=!1,r.touchmoveChangedTouch=null,window.cancelAnimationFrame(r.animationFrameRequestID)))},processDragDelta:function(){var t=this;if(!t.touchmoveChangedTouch){t.animationFrameRequestID=window.requestAnimationFrame(t.processDragDelta.bind(t));return}var r=t.innerContainer,u=t.touchmoveChangedTouch.clientX,e=t.touchmoveChangedTouch.clientY,n=u-t.dragStartX,a=e-t.dragStartY,d=t.translateY+a/2.5,l=t.translateX+n/2.5;d>.5*r.clientHeight-t.MARGIN&&(d=.5*r.clientHeight-t.MARGIN),l>.5*r.clientWidth-t.MARGIN&&(l=.5*r.clientWidth-t.MARGIN),d<-.5*r.clientHeight+t.MARGIN&&(d=-.5*r.clientHeight+t.MARGIN),l<-.5*r.clientWidth+t.MARGIN&&(l=-.5*r.clientWidth+t.MARGIN),t.zoomContainer.style.transform="translate3d("+2.5*l+"px, "+2.5*d+"px, 0) scale3d(2.5, 2.5, 1)",t.lastTranslateX=l,t.lastTranslateY=d,t.animationFrameRequestID=window.requestAnimationFrame(t.processDragDelta.bind(t))},showPossibleMoveAt:function(t,r,u){var e=this,n=this.boardElement,a=this.zoomContainer;if(e.zoomContainerHeight=e.zoomContainerHeight||a.clientHeight,e.zoomContainerWidth=e.zoomContainerWidth||a.clientWidth,e.touchedPoint=t,o.default.hasClass(n,"tenuki-scaled")){var d=r*(this.INTERSECTION_GAP_SIZE+1),l=u*(this.INTERSECTION_GAP_SIZE+1),E=.5*e.zoomContainerHeight-d-e.MARGIN,p=.5*e.zoomContainerWidth-l-e.MARGIN;a.style.transform="translate3d("+2.5*p+"px, "+2.5*E+"px, 0) scale3d(2.5, 2.5, 1)",e.translateY=E,e.translateX=p,o.default.addClass(e.cancelZoomElement,"visible"),e.zoomedIn=!0}},resetTouchedPoint:function(){var t=this;t.touchedPoint=null},zoomOut:function(){var t=this;this.resetTouchedPoint(),t.zoomContainer.style.transform="",t.zoomContainer.style.transition="",t.dragStartX=null,t.dragStartY=null,t.translateY=null,t.translateX=null,t.lastTranslateX=null,t.lastTranslateY=null,o.default.removeClass(t.cancelZoomElement,"visible"),t.zoomedIn=!1},render:function(t){var r=this,u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=u.territory,n=u.deadStones;this._initialized||(this._setup(t),this._initialized=!0),this.resetTouchedPoint(),this.renderStonesPlayed(t.intersections);var a=t.playedPoint;if(this.updateMarkerPoints({playedPoint:a,koPoint:t.koPoint}),this._options.fuzzyStonePlacement&&a){var d=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none"],l=["h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"],E=d.concat(l),p=E.some(function(y){return o.default.hasClass(r.grid[a.y][a.x],y)});if(!p){var f=o.default.cartesianProduct(d,l),h=S(f[Math.floor(Math.random()*f.length)],2),c=h[0],v=h[1];[[-1,0],[0,-1],[0,1],[1,0]].forEach(function(y){var m=S(y,2),P=m[0],A=m[1];if(r.grid[a.y+P]&&r.grid[a.y+P][a.x+A]){var b=r.grid[a.y+P][a.x+A];o.default.hasClass(b,"empty")||[[-1,0,"v-shift-downdown","v-shift-up","v-shift-down"],[-1,0,"v-shift-downdown","v-shift-upup","v-shift-none"],[-1,0,"v-shift-down","v-shift-upup","v-shift-none"],[1,0,"v-shift-upup","v-shift-down","v-shift-up"],[1,0,"v-shift-upup","v-shift-downdown","v-shift-none"],[1,0,"v-shift-up","v-shift-downdown","v-shift-none"],[0,-1,"h-shift-rightright","h-shift-left","h-shift-right"],[0,-1,"h-shift-rightright","h-shift-leftleft","h-shift-none"],[0,-1,"h-shift-right","h-shift-leftleft","h-shift-none"],[0,1,"h-shift-leftleft","h-shift-right","h-shift-left"],[0,1,"h-shift-leftleft","h-shift-rightright","h-shift-none"],[0,1,"h-shift-left","h-shift-rightright","h-shift-none"]].forEach(function(C){var I=S(C,5),w=I[0],R=I[1],T=I[2],k=I[3],N=I[4];P===w&&A===R&&o.default.hasClass(b,T)&&(c===k||v===k)&&(o.default.removeClass(b,T),o.default.addClass(b,N))})}}),o.default.addClass(this.grid[a.y][a.x],c),o.default.addClass(this.grid[a.y][a.x],v)}}(n.length>0||e.black.length>0||e.white.length>0)&&this.renderTerritory(e,n)},renderStonesPlayed:function(t){var r=this;t.forEach(function(u){r.renderIntersection(u)})},updateMarkerPoints:function(t){var r=t.playedPoint,u=t.koPoint,e=this;u&&o.default.addClass(e.grid[u.y][u.x],"ko"),r&&o.default.addClass(e.grid[r.y][r.x],"played")},renderIntersection:function(t){var r=this,u=r.grid[t.y][t.x],e=["intersection"];if(t.isEmpty())e.push("empty");else{e.push("occupied"),t.isBlack()?e.push("black"):e.push("white");var n=["v-shift-up","v-shift-upup","v-shift-down","v-shift-downdown","v-shift-none","h-shift-left","h-shift-leftleft","h-shift-right","h-shift-rightright","h-shift-none"];n.forEach(function(a){o.default.hasClass(u,a)&&e.push(a)})}this.setIntersectionClasses(u,t,e)},renderTerritory:function(t,r){var u=this;o.default.flatten(this.grid).forEach(function(e){o.default.removeClass(e,"territory-black"),o.default.removeClass(e,"territory-white"),o.default.removeClass(e,"dead")}),r.forEach(function(e){o.default.addClass(u.grid[e.y][e.x],"dead")}),t.black.forEach(function(e){o.default.addClass(u.grid[e.y][e.x],"territory-black")}),t.white.forEach(function(e){o.default.addClass(u.grid[e.y][e.x],"territory-white")})}},B.default=_,B}var nt;function St(){if(nt)return F;nt=1,Object.defineProperty(F,"__esModule",{value:!0});var S=O(),i=_(S),o=mt(),g=_(o);function _(t){return t&&t.__esModule?t:{default:t}}var s=function(r,u){var e=u.hooks,n=u.options;g.default.call(this,r,{hooks:e,options:n}),this.smallerStones&&i.default.addClass(r,"tenuki-smaller-stones"),i.default.addClass(r,"tenuki-dom-renderer")};return s.prototype=Object.create(g.default.prototype),s.prototype.constructor=s,s.prototype._setup=function(t){g.default.prototype._setup.call(this,t),this.BOARD_LENGTH+=1,this.computeSizing()},s.prototype.generateBoard=function(t){var r=this,u=i.default.createElement("div");i.default.appendElement(u,i.default.createElement("div",{class:"lines horizontal"})),i.default.appendElement(u,i.default.createElement("div",{class:"lines vertical"})),i.default.appendElement(u,i.default.createElement("div",{class:"hoshi-points"})),i.default.appendElement(u,i.default.createElement("div",{class:"intersections"})),g.default.hoshiPositionsFor(t.boardSize).forEach(function(p){var f=i.default.createElement("div",{class:"hoshi"});f.style.left=p.left*(r.INTERSECTION_GAP_SIZE+1)+"px",f.style.top=p.top*(r.INTERSECTION_GAP_SIZE+1)+"px",i.default.appendElement(u.querySelector(".hoshi-points"),f)});for(var e=0;e<t.boardSize;e++){var n=i.default.createElement("div",{class:"line horizontal"});n.setAttribute("data-left-gutter",t.yCoordinateFor(e)),i.default.appendElement(u.querySelector(".lines.horizontal"),n);var a=i.default.createElement("div",{class:"line vertical"});a.setAttribute("data-top-gutter",t.xCoordinateFor(e)),i.default.appendElement(u.querySelector(".lines.vertical"),a);for(var d=0;d<t.boardSize;d++){var l=i.default.createElement("div",{class:"intersection empty"}),E=i.default.createElement("div",{class:"stone"});i.default.appendElement(l,E),l.setAttribute("data-position-x",d),l.setAttribute("data-position-y",e),l.style.left=d*(this.INTERSECTION_GAP_SIZE+1)+"px",l.style.top=e*(this.INTERSECTION_GAP_SIZE+1)+"px",i.default.appendElement(u.querySelector(".intersections"),l),this.grid[e]=this.grid[e]||[],this.grid[e][d]=l,this.addIntersectionEventListeners(l,e,d)}}return i.default.addEventListener(u.querySelector(".lines.horizontal"),"mousedown",function(p){p.preventDefault()}),i.default.addEventListener(u.querySelector(".lines.vertical"),"mousedown",function(p){p.preventDefault()}),u.querySelector(".lines.horizontal").style.width=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px",u.querySelector(".lines.horizontal").style.height=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px",u.querySelector(".lines.vertical").style.width=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px",u.querySelector(".lines.vertical").style.height=this.INTERSECTION_GAP_SIZE*(t.boardSize-1)+t.boardSize+"px",u},s.prototype.setIntersectionClasses=function(t,r,u){t.className!==u.join(" ")&&(t.className=u.join(" "))},F.default=s,F}var L={},it;function bt(){if(it)return L;it=1,Object.defineProperty(L,"__esModule",{value:!0});var S=O(),i=_(S),o=mt(),g=_(o);function _(u){return u&&u.__esModule?u:{default:u}}var s=function(e,n){var a=n.hooks,d=n.options;g.default.call(this,e,{hooks:a,options:d}),i.default.addClass(e,"tenuki-svg-renderer")};s.prototype=Object.create(g.default.prototype),s.prototype.constructor=s;var t={},r=function(e,n,a){var d=a.hasCoordinates,l=a.smallerStones,E=a.flatStones,p=[n.boardSize,d,l,E].toString(),f=i.default.createSVGElement("svg"),h=i.default.createSVGElement("defs");i.default.appendElement(f,h);var c=i.default.createSVGElement("radialGradient",{attributes:{id:e.blackGradientID,cy:"15%",r:"50%"}});i.default.appendElement(c,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"hsl(0, 0%, 38%)"}})),i.default.appendElement(c,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#39363D"}})),i.default.appendElement(h,c);var v=i.default.createSVGElement("radialGradient",{attributes:{id:e.whiteGradientID,cy:"15%",r:"50%"}});i.default.appendElement(v,i.default.createSVGElement("stop",{attributes:{offset:"0%","stop-color":"#FFFFFF"}})),i.default.appendElement(v,i.default.createSVGElement("stop",{attributes:{offset:"100%","stop-color":"#fafdfc"}})),i.default.appendElement(h,v);var y=i.default.createSVGElement("g",{attributes:{class:"contents",transform:"translate("+e.MARGIN+", "+e.MARGIN+")"}});i.default.appendElement(f,y);var m=void 0;if(t[p])m=i.default.clone(t[p]);else{m=i.default.createSVGElement("g",{attributes:{class:"lines"}});for(var P=0;P<n.boardSize-1;P++)for(var A=0;A<n.boardSize-1;A++){var b=i.default.createSVGElement("rect",{attributes:{y:P*(e.INTERSECTION_GAP_SIZE+1)-.5,x:A*(e.INTERSECTION_GAP_SIZE+1)-.5,width:e.INTERSECTION_GAP_SIZE+1,height:e.INTERSECTION_GAP_SIZE+1,class:"line-box"}});i.default.appendElement(m,b)}t[p]=m}i.default.appendElement(y,m);var C=i.default.createSVGElement("g",{attributes:{class:"hoshi"}});i.default.appendElement(y,C),g.default.hoshiPositionsFor(n.boardSize).forEach(function(G){var J=i.default.createSVGElement("circle",{attributes:{class:"hoshi",cy:G.top*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:G.left*(e.INTERSECTION_GAP_SIZE+1)-.5,r:2}});i.default.appendElement(C,J)}),d&&(function(){for(var G=i.default.createSVGElement("g",{attributes:{class:"coordinates",transform:"translate("+e.MARGIN+", "+e.MARGIN+")"}}),J=function(D){[16/2+1-(16+16/2+16/4+16/8),16/2+1+(16+16/2)+(n.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(tt){i.default.appendElement(G,i.default.createSVGElement("text",{text:n.xCoordinateFor(D),attributes:{"text-anchor":"middle",y:tt-.5,x:D*(e.INTERSECTION_GAP_SIZE+1)-.5}}))}),[-1*(16+16/2+16/4),16+16/2+16/4+(n.boardSize-1)*(e.INTERSECTION_GAP_SIZE+1)].forEach(function(tt){i.default.appendElement(G,i.default.createSVGElement("text",{text:n.yCoordinateFor(D),attributes:{"text-anchor":"middle",y:D*(e.INTERSECTION_GAP_SIZE+1)-.5+16/4,x:tt-.5}}))}),i.default.appendElement(f,G)},Q=0;Q<n.boardSize;Q++)J(Q)})();for(var I=i.default.createSVGElement("g",{attributes:{class:"intersections"}}),w=0;w<n.boardSize;w++)for(var R=0;R<n.boardSize;R++){var T=i.default.createSVGElement("g",{attributes:{class:"intersection"}});T.setAttribute("data-intersection-y",w),T.setAttribute("data-intersection-x",R),i.default.appendElement(I,T);var k=i.default.createSVGElement("g",{attributes:{class:"intersection-inner-container"}});i.default.appendElement(T,k);var N=i.default.createSVGElement("rect",{attributes:{y:w*(e.INTERSECTION_GAP_SIZE+1)-e.INTERSECTION_GAP_SIZE/2-.5,x:R*(e.INTERSECTION_GAP_SIZE+1)-e.INTERSECTION_GAP_SIZE/2-.5,width:e.INTERSECTION_GAP_SIZE,height:e.INTERSECTION_GAP_SIZE}});i.default.appendElement(k,N);var x=e.INTERSECTION_GAP_SIZE/2;l&&(x-=1);var j={class:"stone",cy:w*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:R*(e.INTERSECTION_GAP_SIZE+1)-.5,r:x};E||i.default.appendElement(k,i.default.createSVGElement("circle",{attributes:{class:"stone-shadow",cy:j.cy+2,cx:j.cx,r:x}}));var Et=i.default.createSVGElement("circle",{attributes:j});i.default.appendElement(k,Et),i.default.appendElement(k,i.default.createSVGElement("circle",{attributes:{class:"marker",cy:w*(e.INTERSECTION_GAP_SIZE+1)-.5,cx:R*(e.INTERSECTION_GAP_SIZE+1)-.5,r:4.5}})),i.default.appendElement(k,i.default.createSVGElement("rect",{attributes:{class:"ko-marker",y:w*(e.INTERSECTION_GAP_SIZE+1)-6-.5,x:R*(e.INTERSECTION_GAP_SIZE+1)-6-.5,width:12,height:12}})),i.default.appendElement(k,i.default.createSVGElement("rect",{attributes:{class:"territory-marker",y:w*(e.INTERSECTION_GAP_SIZE+1)-6,x:R*(e.INTERSECTION_GAP_SIZE+1)-6,width:11,height:11}})),e.grid[w]=e.grid[w]||[],e.grid[w][R]=T,e.addIntersectionEventListeners(T,w,R)}return i.default.appendElement(y,I),f};return s.prototype.generateBoard=function(u,e){var n=e.hasCoordinates,a=e.smallerStones,d=e.flatStones;this.blackGradientID=i.default.randomID("black-gradient"),this.whiteGradientID=i.default.randomID("white-gradient");var l=r(this,u,{hasCoordinates:n,smallerStones:a,flatStones:d});return this.svgElement=l,this.svgElement.setAttribute("height",this.BOARD_LENGTH),this.svgElement.setAttribute("width",this.BOARD_LENGTH),l},s.prototype.computeSizing=function(){var u=this;g.default.prototype.computeSizing.call(this),this.svgElement.style.transform="none",window.requestAnimationFrame(function(){u.svgElement.style.transform=""})},s.prototype.setIntersectionClasses=function(u,e,n){if(u.getAttribute("class")!==n.join(" ")&&u.setAttribute("class",n.join(" ")),!this.flatStones)if(e.isEmpty())u.querySelector(".stone").setAttribute("style","");else{var a=window.location.href.split("#")[0];u.querySelector(".stone").setAttribute("style","fill: url("+a+"#"+this[e.value+"GradientID"]+")")}},L.default=s,L}var V={},at;function Pt(){if(at)return V;at=1,Object.defineProperty(V,"__esModule",{value:!0}),V.default=S;function S(){this.setup=function(){},this.render=function(){},this.renderTerritory=function(){}}return V}var Z={},W={},st;function yt(){if(st)return W;st=1,Object.defineProperty(W,"__esModule",{value:!0});var S=function(o,g,_){this.y=o,this.x=g,this.value=_||"empty",Object.freeze(this)};return S.prototype={isOccupiedWith:function(o){return this.isEmpty()?!1:this.value===o},isBlack:function(){return this.value==="black"},isWhite:function(){return this.value==="white"},isEmpty:function(){return this.value==="empty"},sameColorAs:function(o){return this.value===o.value}},W.default=S,W}var H={},ot;function wt(){if(ot)return H;ot=1,Object.defineProperty(H,"__esModule",{value:!0});var S={};function i(o,g,_,s){if(S[o]=S[o]||{},S[o][g]=S[o][g]||{},S[o][g][_]=S[o][g][_]||{},S[o][g][_][s])return S[o][g][_][s];var t=Math.floor(Math.random()*(Math.pow(2,31)-1));return S[o][g][_][s]=t,t}return H.default={hash:function(g,_){var s=0;return _.forEach(function(t){if(!t.isEmpty()){var r=i(g,t.y,t.x,t.value);s=s^r}}),s}},H}var ut;function At(){if(ut)return Z;ut=1,Object.defineProperty(Z,"__esModule",{value:!0});var S=(function(){function e(n,a){var d=[],l=!0,E=!1,p=void 0;try{for(var f=n[Symbol.iterator](),h;!(l=(h=f.next()).done)&&(d.push(h.value),!(a&&d.length===a));l=!0);}catch(c){E=!0,p=c}finally{try{!l&&f.return&&f.return()}finally{if(E)throw p}}return d}return function(n,a){if(Array.isArray(n))return n;if(Symbol.iterator in Object(n))return e(n,a);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),i=O(),o=r(i),g=yt(),_=r(g),s=wt(),t=r(s);function r(e){return e&&e.__esModule?e:{default:e}}var u=function(n){var a=n.moveNumber,d=n.playedPoint,l=n.color,E=n.pass,p=n.blackPassStones,f=n.whitePassStones,h=n.intersections,c=n.blackStonesCaptured,v=n.whiteStonesCaptured,y=n.capturedPositions,m=n.koPoint,P=n.boardSize;this.moveNumber=a,this.playedPoint=d,this.color=l,this.pass=E,this.blackPassStones=p,this.whitePassStones=f,this.intersections=h,this.blackStonesCaptured=c,this.whiteStonesCaptured=v,this.capturedPositions=y,this.koPoint=m,this.boardSize=P,this._positionHash=t.default.hash(P,h),Object.freeze(this)};return u.prototype={copyWithAttributes:function(n){var a=function(p){var f=p.moveNumber,h=p.playedPoint,c=p.color,v=p.pass,y=p.blackPassStones,m=p.whitePassStones,P=p.intersections,A=p.blackStonesCaptured,b=p.whiteStonesCaptured,C=p.capturedPositions,I=p.koPoint,w=p.boardSize;return{moveNumber:f,playedPoint:h,color:c,pass:v,blackPassStones:y,whitePassStones:m,intersections:P,blackStonesCaptured:A,whiteStonesCaptured:b,capturedPositions:C,koPoint:I,boardSize:w}},d=a(this),l=a(Object.assign(d,n));return new u(l)},_capturesFrom:function(n,a,d){var l=this,E=this.neighborsFor(n,a).filter(function(f){return!f.isEmpty()&&f.value!==d&&l.libertiesAt(f.y,f.x)===1}),p=o.default.flatMap(E,function(f){return l.groupAt(f.y,f.x)});return o.default.unique(p)},_updateIntersection:function(n,a,d){return a.map(function(l){return l.y===n.y&&l.x===n.x?new _.default(l.y,l.x,d):l})},_removeIntersection:function(n,a){return this._updateIntersection(n,a,"empty")},_withoutIntersectionsMatching:function(n){var a=this.intersections.map(function(d){return n(d)?new _.default(d.y,d.x,"empty"):d});return this._withNewPoints(a)},_withNewPoints:function(n){return this.copyWithAttributes({intersections:n})},nextColor:function(){return this.color==="black"?"white":"black"},yCoordinateFor:function(n){return this.boardSize-n},xCoordinateFor:function(n){var a=["A","B","C","D","E","F","G","H","J","K","L","M","N","O","P","Q","R","S","T"];return a[n]},playPass:function(n){var a={moveNumber:this.moveNumber+1,playedPoint:null,color:n,pass:!0,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:this.intersections,blackStonesCaptured:this.blackStonesCaptured,whiteStonesCaptured:this.whiteStonesCaptured,capturedPositions:[],koPoint:null,boardSize:this.boardSize};a[n+"PassStones"]+=1;var d=new u(a);return d},_simpleKoPoint:function(){var n=null;if(this.playedPoint){var a=this.playedPoint,d=a.y,l=a.x;this.capturedPositions.length===1&&this.groupAt(d,l).length===1&&this.inAtari(d,l)&&(n=this.capturedPositions[0])}return n},playAt:function(n,a,d){var l=this,E=this._capturesFrom(n,a,d),p=this.intersectionAt(n,a),f=this.intersections;E.forEach(function(A){f=l._removeIntersection(A,f)}),f=this._updateIntersection(p,f,d);var h=this.blackStonesCaptured+(d==="black"?0:E.length),c=this.whiteStonesCaptured+(d==="white"?0:E.length),v=this.boardSize,y={moveNumber:this.moveNumber+1,playedPoint:Object.freeze({y:n,x:a}),color:d,pass:!1,blackPassStones:this.blackPassStones,whitePassStones:this.whitePassStones,intersections:f,blackStonesCaptured:h,whiteStonesCaptured:c,capturedPositions:E,boardSize:v},m=new u(y),P=m._simpleKoPoint();return P?y.koPoint={y:P.y,x:P.x}:y.koPoint=null,new u(y)},intersectionAt:function(n,a){if(n>=this.boardSize||a>=this.boardSize)throw new Error("Intersection at ("+n+", "+a+") would be outside the board");if(n<0||a<0)throw new Error("Intersection position cannot be negative, but was given ("+n+", "+a+")");return this.intersections[n*this.boardSize+a]},groupAt:function(n,a){var d=this.intersectionAt(n,a),l=this.partitionTraverse(d,function(f){return f.sameColorAs(d)}),E=S(l,2),p=E[0];return E[1],p},libertiesAt:function(n,a){var d=this,l=this.intersectionAt(n,a),E=o.default.flatMap(this.groupAt(l.y,l.x),function(p){return d.neighborsFor(p.y,p.x).filter(function(f){return f.isEmpty()})});return o.default.unique(E).length},inAtari:function(n,a){return this.libertiesAt(n,a)===1},neighborsFor:function(n,a){var d=[];return a>0&&d.push(this.intersectionAt(n,a-1)),a<this.boardSize-1&&d.push(this.intersectionAt(n,a+1)),n>0&&d.push(this.intersectionAt(n-1,a)),n<this.boardSize-1&&d.push(this.intersectionAt(n+1,a)),d},positionSameAs:function(n){return this._positionHash===n._positionHash&&this.intersections.every(function(a){return a.sameColorAs(n.intersectionAt(a.y,a.x))})},partitionTraverse:function(n,a){var d=[],l=[],E=[];for(E.push(n);E.length>0;){var p=E.pop();d.indexOf(p)>-1||(d.push(p),this.neighborsFor(p.y,p.x).forEach(function(f){d.indexOf(f)>-1||(a(f)?E.push(f):l.push(f))}))}return[d,o.default.unique(l)]}},u._initialFor=function(e,n){if(this._cache=this._cache||{},this._cache[e]=this._cache[e]||{},this._cache[e][n])return this._cache[e][n];var a=Array.apply(null,Array(e*e));a=a.map(function(f,h){return new _.default(Math.floor(h/e),h%e)});var d=e>11?3:2,l={topRight:{y:d,x:e-d-1},bottomLeft:{y:e-d-1,x:d},bottomRight:{y:e-d-1,x:e-d-1},topLeft:{y:d,x:d},middle:{y:(e+1)/2-1,x:(e+1)/2-1},middleLeft:{y:(e+1)/2-1,x:d},middleRight:{y:(e+1)/2-1,x:e-d-1},middleTop:{y:d,x:(e+1)/2-1},middleBottom:{y:e-d-1,x:(e+1)/2-1}},E={0:[],1:[],2:[l.topRight,l.bottomLeft],3:[l.topRight,l.bottomLeft,l.bottomRight],4:[l.topRight,l.bottomLeft,l.bottomRight,l.topLeft],5:[l.topRight,l.bottomLeft,l.bottomRight,l.topLeft,l.middle],6:[l.topRight,l.bottomLeft,l.bottomRight,l.topLeft,l.middleLeft,l.middleRight],7:[l.topRight,l.bottomLeft,l.bottomRight,l.topLeft,l.middleLeft,l.middleRight,l.middle],8:[l.topRight,l.bottomLeft,l.bottomRight,l.topLeft,l.middleLeft,l.middleRight,l.middleTop,l.middleBottom],9:[l.topRight,l.bottomLeft,l.bottomRight,l.topLeft,l.middleLeft,l.middleRight,l.middleTop,l.middleBottom,l.middle]};E[n].forEach(function(f){a[f.y*e+f.x]=new _.default(f.y,f.x,"black")});var p=new u({color:n>1?"black":"white",moveNumber:0,intersections:Object.freeze(a),blackStonesCaptured:0,whiteStonesCaptured:0,whitePassStones:0,blackPassStones:0,boardSize:e});return this._cache[e][n]=p,p},Z.default=u,Z}var $={},lt;function Ct(){if(lt)return $;lt=1,Object.defineProperty($,"__esModule",{value:!0});var S=["simple","positional-superko","situational-superko","natural-situational-superko"],i=function(g){var _=g.koRule;if(this.koRule=_,S.indexOf(this.koRule)<0)throw new Error("Unknown ko rule: "+_);Object.freeze(this)};return i.prototype={isIllegal:function(g,_,s){var t=s.currentState(),r=t.intersectionAt(g,_),u=!r.isEmpty()||this._wouldBeSuicide(g,_,t)||this._isKoViolation(g,_,t,s._moves);return u},_isKoViolation:function(g,_,s,t){var r=!1;if(this.koRule==="simple"){var u=s._simpleKoPoint();r=!!u&&g===u.y&&_===u.x}else{var e=s.playAt(g,_,s.nextColor()),n=function(d){return t.length>0&&t.some(function(l){return d(l)&&l.positionSameAs(e)})};if(this.koRule==="positional-superko")r=n(function(){return!0});else if(this.koRule==="situational-superko")r=n(function(a){return a.color===e.color});else if(this.koRule==="natural-situational-superko")r=n(function(a){return!a.pass&&a.color===e.color});else throw new Error("Unimplemented ko rule "+this.koRule)}return r},_wouldBeSuicide:function(g,_,s){var t=s.nextColor(),r=s.intersectionAt(g,_),u=r.isEmpty()&&s.neighborsFor(r.y,r.x).filter(function(a){return a.isEmpty()}).length===0;if(!u)return!1;var e=s.neighborsFor(r.y,r.x).some(function(a){var d=s.inAtari(a.y,a.x),l=a.isOccupiedWith(t);return l&&!d});if(e)return!1;var n=s.neighborsFor(r.y,r.x).some(function(a){var d=s.inAtari(a.y,a.x),l=!a.isOccupiedWith(t);return l&&d});return!n}},$.default=i,$}var K={},X={},dt;function It(){if(dt)return X;dt=1,Object.defineProperty(X,"__esModule",{value:!0});var S=(function(){function s(t,r){var u=[],e=!0,n=!1,a=void 0;try{for(var d=t[Symbol.iterator](),l;!(e=(l=d.next()).done)&&(u.push(l.value),!(r&&u.length===r));e=!0);}catch(E){n=!0,a=E}finally{try{!e&&d.return&&d.return()}finally{if(n)throw a}}return u}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return s(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),i=O(),o=g(i);function g(s){return s&&s.__esModule?s:{default:s}}var _=function(t,r){this.boardState=t,this.intersections=r,this._computed={},Object.freeze(this)};return _._startingAt=function(s,t,r){var u=s.intersectionAt(t,r),e=s.partitionTraverse(u,function(l){return l.sameColorAs(u)}),n=S(e,2),a=n[0],d=n[1];return[a,d]},_.allFor=function(s){var t=[],r=[];return s.intersections.forEach(function(u){if(!(t.indexOf(u)>-1)){var e=s.partitionTraverse(u,function(d){return d.sameColorAs(u)}),n=S(e,2),a=n[0];n[1],r.push(new _(s,a)),t=t.concat(a)}}),r},_.merge=function(s,t){for(var r=[t],u=-1;r.length!==u;)u=r.length,r=s.filter(function(e){return e.isEmpty()&&e.isTerritory()&&e.territoryColor()===t.territoryColor()&&e.expandedBoundaryStones().some(function(n){return r.some(function(a){return a.expandedBoundaryStones().indexOf(n)>-1})})});return r},_.prototype={isEmpty:function(){return this.intersections[0].isEmpty()},isTerritory:function(){var t=this.intersections[0];if(!t.isEmpty())return!1;var r=_._startingAt(this.boardState,t.y,t.x),u=S(r,2);u[0];var e=u[1],n=o.default.unique(e.map(function(d){return d.value})),a=n.length===1&&n[0]!=="empty";return a},territoryColor:function(){var t=this.intersections[0],r=_._startingAt(this.boardState,t.y,t.x),u=S(r,2);u[0];var e=u[1],n=o.default.unique(e.map(function(d){return d.value})),a=n.length===1&&n[0]!=="empty";if(!t.isEmpty()||!a)throw new Error("Attempted to obtain territory color for something that isn't territory, region containing "+t.y+","+t.x);return n[0]},isBlack:function(){return this.territoryColor()==="black"},isWhite:function(){return this.territoryColor()==="white"},isNeutral:function(){return!this.intersections[0].isBlack()&&!this.intersections[0].isWhite()&&!this.isTerritory()},exterior:function(){var t=this;return this.boardState.intersections.filter(function(r){return t.intersections.indexOf(r)<0&&t.boardState.neighborsFor(r.y,r.x).some(function(u){return t.intersections.indexOf(u)>-1})})},boundaryStones:function(){var t=this;if(this._computed.boundaryStones)return this._computed.boundaryStones;if(!this.isEmpty())throw new Error("Attempted to obtain boundary stones for non-empty region");return this._computed.boundaryStones=this.exterior().filter(function(r){return!r.sameColorAs(t.intersections[0])}),this._computed.boundaryStones},expandedBoundaryStones:function(){if(this._computed.expandedBoundaryStones)return this._computed.expandedBoundaryStones;var t=this.boundaryStones(),r=_.allFor(this.boardState).filter(function(u){return u.intersections.some(function(e){return t.indexOf(e)>-1})});return this._computed.expandedBoundaryStones=o.default.flatMap(r,function(u){return u.intersections}),this._computed.expandedBoundaryStones},lengthOfTerritoryBoundary:function(){var t=this,r=this.intersections.filter(function(e){return e.y===0||e.y===t.boardState.boardSize-1||e.x===0||e.x===t.boardState.boardSize-1}),u=this.intersections.filter(function(e){return e.y%t.boardState.boardSize-1===0&&e.x%t.boardState.boardSize-1===0});return this.boundaryStones().length+r.length+u.length},containsSquareFour:function(){var t=this;return this.intersections.some(function(r){return[[0,0],[0,1],[1,0],[1,1]].every(function(u){var e=S(u,2),n=e[0],a=e[1],d=r.y+n,l=r.x+a,E=d>=0&&d<t.boardState.boardSize&&l>=0&&l<t.boardState.boardSize;return E&&t.boardState.intersectionAt(d,l).sameColorAs(r)})})},containsCurvedFour:function(){var t=this;return this.intersections.some(function(r){return[[[0,0],[1,0],[2,0],[2,1]],[[-1,2],[0,0],[0,1],[0,2]],[[0,0],[0,1],[1,1],[2,1]],[[-1,0],[-1,1],[-1,2],[0,0]],[[-2,1],[-1,1],[0,0],[0,1]],[[0,0],[1,0],[1,1],[1,2]],[[0,-1],[0,0],[1,-1],[2,-1]],[[-1,-2],[-1,-1],[-1,0],[0,0]]].some(function(u){return u.every(function(e){var n=S(e,2),a=n[0],d=n[1],l=r.y+a,E=r.x+d,p=l>=0&&l<t.boardState.boardSize&&E>=0&&E<t.boardState.boardSize;return p&&t.boardState.intersectionAt(l,E).sameColorAs(r)})})})},numberOfEyes:function(){if(!this.intersections[0].isEmpty())throw new Error("Unexpected calculation of number of eyes for a non-empty region containing "+this.intersections[0].y+","+this.intersections[0].x);var t=this.lengthOfTerritoryBoundary();if(t<2)throw new Error("Unexpected boundary length of "+t+" for region including "+this.intersections[0].y+","+this.intersections[0].x);if(t>=10)return 2;var r=void 0;switch(t){case 2:case 3:case 4:case 5:case 6:r=1;break;case 7:r=1.5;break;case 8:this.containsSquareFour()?r=1:this.containsCurvedFour()?r=2:r=1.5;break;case 9:this.containsSquareFour()?r=1.5:r=2;break;default:throw new Error("unhandled boundary length "+t)}return r}},X.default=_,X}var Y={},ft;function kt(){if(ft)return Y;ft=1,Object.defineProperty(Y,"__esModule",{value:!0});var S=function(o,g){this.boardState=o,this.intersection=g,Object.freeze(this)};return S.prototype={diagonals:function(){var o=this,g=[],_=[],s=[];return this.intersection.x>0&&_.push(this.intersection.x-1),this.intersection.x<this.boardState.boardSize-1&&_.push(this.intersection.x+1),this.intersection.y>0&&s.push(this.intersection.y-1),this.intersection.y<this.boardState.boardSize-1&&s.push(this.intersection.y+1),_.forEach(function(t){s.forEach(function(r){g.push(o.boardState.intersectionAt(r,t))})}),g},isFalse:function(){if(!this.intersection.isEmpty())return!1;var o=this.diagonals(),g=o.length<=2,_=this.neighbors(),s=_.filter(function(r){return!r.isEmpty()});if(g&&s.length<1||!g&&s.length<2)return!1;var t=o.filter(function(r){return!r.isEmpty()&&!r.sameColorAs(s[0])});return g?t.length>=1:t.length>=2},neighbors:function(){return this.boardState.neighborsFor(this.intersection.y,this.intersection.x)},filledColor:function(){if(!this.isFalse())throw new Error("Attempting to find filled color for a non-false eye");return this.neighbors()[0].value}},Y.default=S,Y}var ct;function Rt(){if(ct)return K;ct=1,Object.defineProperty(K,"__esModule",{value:!0});var S=O(),i=u(S),o=yt(),g=u(o),_=It(),s=u(_),t=kt(),r=u(t);function u(p){return p&&p.__esModule?p:{default:p}}var e=function(f){return f.currentState()._withoutIntersectionsMatching(function(h){return f._isDeadAt(h.y,h.x)})},n=function(f){var h=s.default.allFor(f),c=h.filter(function(m){return m.isNeutral()});if(h.length===0||c.length===0)return f;var v={};c.forEach(function(m){var P=null,A=null;m.intersections.forEach(function(b){P=P||b.x,P=P||b.y;var C=Math.abs(b.y-A)+Math.abs(b.x-P),I=["black","white"][C%2],w=new g.default(b.y,b.x,I);v[b.y]=v[b.y]||[],v[b.y][b.x]=w})});var y=f.intersections.map(function(m){return v[m.y]&&v[m.y][m.x]?v[m.y][m.x]:m});return f._withNewPoints(y)},a=function(f){for(var h=s.default.allFor(f).filter(function(P){return P.isTerritory()}),c=i.default.flatMap(h,function(P){return P.intersections}).filter(function(P){return new r.default(f,P).isFalse()}),v=c.filter(function(P){return f.neighborsFor(P.y,P.x).some(function(A){return f.inAtari(A.y,A.x)})}),y=f,m=function(){var A=y.intersections.map(function(w){return v.indexOf(w)>-1?new g.default(w.y,w.x,new r.default(y,w).filledColor()):w});y=y._withNewPoints(A);var b=n(y),C=s.default.allFor(b).filter(function(w){return w.isTerritory()}),I=i.default.flatMap(C,function(w){return w.intersections}).filter(function(w){return new r.default(b,w).isFalse()});v=I.filter(function(w){return y.neighborsFor(w.y,w.x).some(function(R){return y.inAtari(R.y,R.x)})})};v.length>0;)m();return y},d=Object.freeze({score:function(f){var h=f.deadStones().filter(function(m){return f.intersectionAt(m.y,m.x).isBlack()}),c=f.deadStones().filter(function(m){return f.intersectionAt(m.y,m.x).isWhite()}),v=f.territory(),y=f.currentState();return{black:v.black.length+y.whiteStonesCaptured+c.length,white:v.white.length+y.blackStonesCaptured+h.length}},territory:function(f){var h=e(f),c=n(h),v=a(c),y=s.default.allFor(v).filter(function(b){return b.isTerritory()}),m=y.filter(function(b){var C=s.default.merge(y,b),I=C.map(function(w){return Math.ceil(w.numberOfEyes())});return I.length>0&&I.reduce(function(w,R){return w+R})>=2}),P=m.filter(function(b){return b.isBlack()}),A=m.filter(function(b){return b.isWhite()});return{black:i.default.flatMap(P,function(b){return b.intersections}).map(function(b){return{y:b.y,x:b.x}}),white:i.default.flatMap(A,function(b){return b.intersections}).map(function(b){return{y:b.y,x:b.x}})}}}),l=Object.freeze({score:function(f){var h=f.intersections().filter(function(y){return y.isBlack()&&!f._isDeadAt(y.y,y.x)}),c=f.intersections().filter(function(y){return y.isWhite()&&!f._isDeadAt(y.y,y.x)}),v=f.territory();return{black:v.black.length+h.length,white:v.white.length+c.length}},territory:function(f){var h=s.default.allFor(e(f)),c=h.filter(function(m){return m.isTerritory()}),v=c.filter(function(m){return m.isBlack()}),y=c.filter(function(m){return m.isWhite()});return{black:i.default.flatMap(v,function(m){return m.intersections}).map(function(m){return{y:m.y,x:m.x}}),white:i.default.flatMap(y,function(m){return m.intersections}).map(function(m){return{y:m.y,x:m.x}})}}}),E=function(){var f=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},h=f.scoreBy,c=f.komi;if(this._strategy={area:l,territory:d,equivalence:l}[h],this._komi=c,!this._strategy)throw new Error("Unknown scoring type: "+h);if(this._komi===null||typeof this._komi>"u")throw new Error("Error initializing scorer without a komi value");if(typeof this._komi!="number")throw new Error("Komi value given is not a number: "+c);this._usePassStones=h==="equivalence",Object.freeze(this)};return E.prototype={score:function(f){var h=this._strategy.score(f);if(h.white+=this._komi,this._usePassStones){var c=f.currentState().color!=="white";return{black:h.black+f.currentState().whitePassStones+(c?1:0),white:h.white+f.currentState().blackPassStones}}else return h},territory:function(f){return this._strategy.territory(f)},usingPassStones:function(){return this._usePassStones}},K.default=E,K}var ht;function gt(){if(ht)return M;ht=1,Object.defineProperty(M,"__esModule",{value:!0});var S=(function(){function h(c,v){var y=[],m=!0,P=!1,A=void 0;try{for(var b=c[Symbol.iterator](),C;!(m=(C=b.next()).done)&&(y.push(C.value),!(v&&y.length===v));m=!0);}catch(I){P=!0,A=I}finally{try{!m&&b.return&&b.return()}finally{if(P)throw A}}return y}return function(c,v){if(Array.isArray(c))return c;if(Symbol.iterator in Object(c))return h(c,v);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),i=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(h){return typeof h}:function(h){return h&&typeof Symbol=="function"&&h.constructor===Symbol&&h!==Symbol.prototype?"symbol":typeof h},o=St(),g=E(o),_=bt(),s=E(_),t=Pt(),r=E(t),u=At(),e=E(u),n=Ct(),a=E(n),d=Rt(),l=E(d);function E(h){return h&&h.__esModule?h:{default:h}}var p=["element","boardSize","scoring","handicapStones","koRule","komi","_hooks","fuzzyStonePlacement","renderer","freeHandicapPlacement"],f=function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._validateOptions(c),this._defaultBoardSize=19,this.boardSize=null,this._moves=[],this.callbacks={postRender:function(){}},this._boardElement=c.element,this._defaultScoring="territory",this._defaultKoRule="simple",this._defaultRenderer="svg",this._deadPoints=[],this._setup(c)};return f.prototype={_validateOptions:function(c){for(var v in c)if(c.hasOwnProperty(v)){if(p.indexOf(v)<0)throw new Error("Unrecognized game option: "+v);if(typeof c[v]>"u"||c[v]===null)throw new Error("Game option "+v+" must not be set as null or undefined")}},_configureOptions:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=c.boardSize,y=v===void 0?this._defaultBoardSize:v,m=c.komi,P=m===void 0?0:m,A=c.handicapStones,b=A===void 0?0:A,C=c.freeHandicapPlacement,I=C===void 0?!1:C,w=c.scoring,R=w===void 0?this._defaultScoring:w,T=c.koRule,k=T===void 0?this._defaultKoRule:T,N=c.renderer,x=N===void 0?this._defaultRenderer:N;if(typeof y!="number")throw new Error("Board size must be a number, but was: "+(typeof y>"u"?"undefined":i(y)));if(typeof b!="number")throw new Error("Handicap stones must be a number, but was: "+(typeof y>"u"?"undefined":i(y)));if(b>0&&y!==9&&y!==13&&y!==19)throw new Error("Handicap stones not supported on sizes other than 9x9, 13x13 and 19x19");if(b<0||b===1||b>9)throw new Error("Only 2 to 9 handicap stones are supported");if(y>19)throw new Error("cannot generate a board size greater than 19");if(this.boardSize=y,this.handicapStones=b,this._freeHandicapPlacement=I,this._scorer=new l.default({scoreBy:R,komi:P}),this._rendererChoice={dom:g.default,svg:s.default}[x],!this._rendererChoice)throw new Error("Unknown renderer: "+x);this._ruleset=new a.default({koRule:k}),this._freeHandicapPlacement?this._initialState=e.default._initialFor(y,0):this._initialState=e.default._initialFor(y,b)},_stillPlayingHandicapStones:function(){return this._freeHandicapPlacement&&this.handicapStones>0&&this._moves.length<this.handicapStones},_setup:function(){var c=this,v=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(this._validateOptions(v),this._configureOptions(v),this._boardElement){var y={handleClick:function(P,A){c.isOver()?c.toggleDeadAt(P,A):c.playAt(P,A)},hoverValue:function(P,A){if(!c.isOver()&&!c.isIllegalAt(P,A))return c.currentPlayer()},gameIsOver:function(){return c.isOver()}};this.renderer=new this._rendererChoice(this._boardElement,{hooks:v._hooks||y,options:{fuzzyStonePlacement:v.fuzzyStonePlacement}})}else this.renderer=new r.default;this.render()},intersectionAt:function(c,v){return this.currentState().intersectionAt(c,v)},intersections:function(){return this.currentState().intersections},deadStones:function(){return this._deadPoints},coordinatesFor:function(c,v){return this.currentState().xCoordinateFor(v)+this.currentState().yCoordinateFor(c)},currentPlayer:function(){return this._stillPlayingHandicapStones()?"black":this.currentState().nextColor()},isWhitePlaying:function(){return this.currentPlayer()==="white"},isBlackPlaying:function(){return this.currentPlayer()==="black"},score:function(){return this._scorer.score(this)},currentState:function(){return this._moves[this._moves.length-1]||this._initialState},moveNumber:function(){return this.currentState().moveNumber},playAt:function(c,v){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=y.render,P=m===void 0?!0:m;if(this.isIllegalAt(c,v))return!1;var A=this.currentState().playAt(c,v,this.currentPlayer()),b=A,C=b.koPoint;return C&&!this._ruleset._isKoViolation(C.y,C.x,A,this._moves.concat(A))&&(A=A.copyWithAttributes({koPoint:null})),this._moves.push(A),P&&this.render(),!0},pass:function(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},v=c.render,y=v===void 0?!0:v;if(this.isOver())return!1;var m=this.currentState().playPass(this.currentPlayer());return this._moves.push(m),y&&this.render(),!0},isOver:function(){if(this._moves.length<2)return!1;var c=this._moves[this._moves.length-1],v=this._moves[this._moves.length-2];return c.pass&&v.pass},markDeadAt:function(c,v){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=y.render,P=m===void 0?!0:m;return this._isDeadAt(c,v)?!0:this._setDeadStatus(c,v,!0,{render:P})},unmarkDeadAt:function(c,v){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=y.render,P=m===void 0?!0:m;return this._isDeadAt(c,v)?this._setDeadStatus(c,v,!1,{render:P}):!0},toggleDeadAt:function(c,v){var y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},m=y.render,P=m===void 0?!0:m;return this._setDeadStatus(c,v,!this._isDeadAt(c,v),{render:P})},_setDeadStatus:function(c,v,y){var m=this,P=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},A=P.render,b=A===void 0?!0:A,C=this.intersectionAt(c,v);if(!C.isEmpty()){var I=[],w=this.currentState().partitionTraverse(C,function(k){return k.isEmpty()||k.sameColorAs(C)}),R=S(w,1),T=R[0];return T.forEach(function(k){k.isEmpty()||I.push(k)}),I.forEach(function(k){y?m._deadPoints.push({y:k.y,x:k.x}):m._deadPoints=m._deadPoints.filter(function(N){return!(N.y===k.y&&N.x===k.x)})}),b&&this.render(),!0}},_isDeadAt:function(c,v){return this._deadPoints.some(function(y){return y.y===c&&y.x===v})},isIllegalAt:function(c,v){return this._ruleset.isIllegal(c,v,this)},territory:function(){return this.isOver()?this._scorer.territory(this):{black:[],white:[]}},undo:function(){this._moves.pop(),this.render()},render:function(){this.isOver()||(this._deadPoints=[]),this.renderer.render(this.currentState(),{territory:this.territory(),deadStones:this.deadStones()}),this.callbacks.postRender(this)}},M.default=f,M}var U={},vt;function Tt(){if(vt)return U;vt=1,Object.defineProperty(U,"__esModule",{value:!0});var S=gt(),i=o(S);function o(s){return s&&s.__esModule?s:{default:s}}function g(s){if(Array.isArray(s)){for(var t=0,r=Array(s.length);t<s.length;t++)r[t]=s[t];return r}else return Array.from(s)}var _=function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._boardElement=t.element,this._setup(t)};return _.prototype={_setup:function(t){var r=this,u=t.player,e=t.gameOptions,n=t.hooks;if(this._player=u,this._hooks=n,this._player!=="black"&&this._player!=="white")throw new Error("Player must be either black or white, but was given: "+this._player);e._hooks={handleClick:function(d,l){if(!r._busy)if(r._busy=!0,r.isOver()){var E=r._game.currentState().groupAt(d,l).map(function(p){return{y:p.y,x:p.x,color:p.color}});r._hooks.submitMarkDeadAt(d,l,E,function(p){p&&r._game.toggleDeadAt(d,l),r._busy=!1})}else{if(r._player!==r.currentPlayer()||r._game.isIllegalAt(d,l)){r._busy=!1;return}r._hooks.submitPlay(d,l,function(p){p&&r._game.playAt(d,l),r._busy=!1})}},hoverValue:function(d,l){if(!r._busy&&r._player===r.currentPlayer()&&!r.isOver()&&!r._game.isIllegalAt(d,l))return r._player},gameIsOver:function(){return r.isOver()}},this._boardElement?this._game=new i.default(Object.assign({element:this._boardElement},e)):this._game=new(Function.prototype.bind.apply(i.default,[null].concat(g(e))))},isOver:function(){return this._game.isOver()},currentPlayer:function(){return this._game.currentPlayer()},receivePlay:function(t,r){this._player!==this.currentPlayer()&&this._game.playAt(t,r)},moveNumber:function(){return this._game.moveNumber()},receivePass:function(){this._player!==this.currentPlayer()&&this._game.pass()},receiveMarkDeadAt:function(t,r){this._game.toggleDeadAt(t,r)},deadStones:function(){return this._game.deadStones()},setDeadStones:function(t){this._game._deadPoints=t.map(function(r){return{y:r.y,x:r.x}}),this._game.render()},pass:function(){var t=this;this._busy||this._player!==this.currentPlayer()||this.isOver()||(this._busy=!0,this._hooks.submitPass(function(r){r&&t._game.pass(),t._busy=!1}))}},U.default=_,U}var pt;function Nt(){return pt||(pt=1,z.Game=gt().default,z.Client=Tt().default,z.utils=O().default),z}var Ot=Nt();function _t(){const S=document.getElementById("tenuki-board");if(S&&S.childElementCount===0){const i=new Ot.Game({element:S,boardSize:19});i.setup(),i.render()}}_t();document.addEventListener("astro:after-swap",_t);
